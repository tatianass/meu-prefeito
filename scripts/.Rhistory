source("imports.R")
tre_sagres <- read.csv('../../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
source("imports.R")
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora")
dados_completos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos)) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
View(indicadores_cont_cid)
?summarise
summarise(mtcars, mean(disp))
mtcars
summarise(group_by(mtcars, cyl), mean(disp))
group_by(mtcars, cyl)
group_by()
?group_by
group_by(indicadores_cont_cid, Ini_Gestao) %>% summarise(mean(nu_Contratos))
group_by(indicadores_cont_cid, Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas))
dados_completos <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
filter(Candidato2016) %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos)) %>%
dados_completos <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
filter(Candidato2016) %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
dados_completos <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
filter(Candidato2016) %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
group_by(indicadores_cont_cid, Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean())
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
filter(Candidato2016) %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
group_by(indicadores_cont_cid, Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean())
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean())
View(indicadores_cont_cid)
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean())
indicadores_cont_cid
indicadores_cont_cid %>% group_by(Ini_Gestao)
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas))
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean(nu_Dispensas_Percent))
22.12444/381.8089
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
View(indicadores_cont_cid)
13/509
indicadores_cont_cid[1,]
indicadores_cont_cid[2,]
16/447
(13/509 + 16/447)/2
indicadores_cont_cid[1:2,] %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean(nu_Dispensas_Percent))
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean(nu_Dispensas_Percent))
22/381
27/265
fixed(1.128347132904321674821, digits=2)
options(1.2145digits=2)
options(1.2145,digits=2)
round(1.2456789, digits=2)
round(1222.2456789, digits=2)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(a=mean(nu_Contratos), b=mean(nu_Dispensas), c=a/b)
22.12444/381.8089
27.90625/265.2277
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas))
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean(nu_Aditivo_Prazo), mean(nu_Aditivo_Valor))
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(mean(nu_Contratos), mean(nu_Dispensas), mean(nu_Aditivo_Prazo), mean(nu_Aditivo_Valor), mean(nu_Convites))
indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>% summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB)
View(indicadores_cont_PB)
22.12444/381.8089
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
View(indicadores_cont_PB)
View(indicadores_cont_cid)
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
View(indicadores_cont_PB)
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
View(indicadores_cont_PB)
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos), Media_Dispensas_PB=mean(nu_Dispensas), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor), Media_Convites_PB=mean(nu_Convites),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
mean
?mean
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
?MEAN
mean
?mean
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
