hist(reeleitos$Porcentagem_limite_despesas, breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1))
hist(reeleitos$Porcentagem_limite_despesas, breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,7))
shapiro.test(reeleitos$Porcentagem_limite_despesas)
?shapiro.test
shapiro.test(rnorm(100, mean = 5, sd = 3))
shapiro.test(runif(100, min = 2, max = 4))
hist(eleitos.1$Porcentagem_limite_despesas, breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1,7))
hist(eleitos.1$Porcentagem_limite_despesas, breaks = c(0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1))
shapiro.test(eleitos.1$Porcentagem_limite_despesas)
mean(reeleitos$Porcentagem_limite_despesas)
mean(eleitos.1$Porcentagem_limite_despesas)
summarise(reeleitos$Porcentagem_limite_despesas)
summary(reeleitos$Porcentagem_limite_despesas)
reeleitos$Porcentagem_limite_despesas
summary(eleitos.1$Porcentagem_limite_despesas)
summary(reeleitos$Porcentagem_limite_despesas)
summary(eleitos.1$Porcentagem_limite_despesas)
candidatos <- read.csv("../data/candidatos.csv", sep=";")
candidatos$Porcentagem_limite_despesas <- with(candidatos, Soma_gastos/Limite_de_despesas)
View(candidatos)
candidatos <- read.csv("../data/candidatos.csv", sep=";")
reeleitos <- candidatos %>% filter(Descricao_ocupacao == "VEREADOR", Cargo == "Vereador", Situação_classe == "Eleito")
candidatos <- read.csv("../data/candidatos.csv", sep=";")
candidatos$Porcentagem_limite_despesas <- with(candidatos, Soma_gastos/Limite_de_despesas)
# comparar gastos de campanhas dos reeleitos com os eleitos sem estar no cargo
reeleitos <- candidatos %>% filter(Descricao_ocupacao == "VEREADOR", Cargo == "Vereador", Situação_classe == "Eleito")
eleitos.1 <- candidatos %>% filter(Descricao_ocupacao != "VEREADOR", Cargo == "Vereador", Situação_classe == "Eleito")
cidades <- read.csv("../data/municipios.csv", sep=";")
View(cidades)
source("imports.R")
separa_partido_coligacao <- function(x){
partido_coligacao_list <- str_split(x, " / ", n = 2) %>%
lapply(function(y) {
if (is.na(y[2])) {
y[2] <- "-"
}
y
})
partido_coligacao <- do.call(rbind, partido_coligacao_list) %>% data.frame
partido_coligacao <- transmute(partido_coligacao, Partido=as.character(X1), Coligação=as.character(X2))
return(partido_coligacao)
}
# Informacoes pessoais dos candidatos
informacoes_pessoais_candidatos <- read.csv("../data/consulta_cand_2016_PB.txt", sep=";", header = F, stringsAsFactors = F, encoding = "latin1", col.names = c("Data_geracao","Dora_geracao","Ano_eleicao","Num_turno","Descricao_eleicao","Sigla_uf","Sigla_ue","Descricao_ue","Codigo_cargo","Descricao_cargo","Nome_candidato","Sequencial_candidato",
"Numero_candidato_urna","CPF_candidato","Nome_urna_candidato","Cod_situacao_candidatura","Descricao_situacao_candidatura","Numero_partido","Sigla_partido","Nome_partido","Codigo_legenda","Sigla_legenda","Composicao_legenda","Nome_legenda",
"Codigo_ocupacao","Descricao_ocupacao","Data_nascimento","Num_titulo_eleitoral_candidato","Idade_data_eleicao","Codigo_sexo","Descricao_sexo","Cod_grau_instrucao","Descricao_grau_instrucao","Codigo_estado_civil","Descricao_estado_civil","Codigo_cor_raca",
"Descricao_cor_raca","Codigo_nacionalidade","Descricao_nacionalidade","Sigla_uf_nascimento","Codigo_municipio_nascimento","Nome_municipio_nascimento","Despesa_max_campanha","Cod_situacao_totalizacao_turno","Descricao_situacao_totalizacao_turno","Email"))
informacoes_pessoais_candidatos <- informacoes_pessoais_candidatos %>% filter(Descricao_cargo %in% c("PREFEITO","VEREADOR"), Descricao_situacao_candidatura %in% c("DEFERIDO","DEFERIDO COM RECURSO")) %>%
select(Nome_candidato,CPF_candidato,Descricao_ue,-Descricao_cargo,Numero_candidato_urna,-Descricao_situacao_candidatura,Descricao_ocupacao,Idade_data_eleicao,Descricao_sexo,Descricao_grau_instrucao,Descricao_estado_civil,Descricao_cor_raca,Descricao_nacionalidade,Sigla_uf_nascimento,Nome_municipio_nascimento)
informacoes_pessoais_candidatos$Descricao_ue <- iconv(informacoes_pessoais_candidatos$Descricao_ue, from="latin1", to="ASCII//TRANSLIT")
# Adiciona cargo, partido, coligação e votação dos candidatos
todos_candidatos <- read.csv("../data/eleicao_todos_candidatos.csv", sep=";", stringsAsFactors = F, encoding = "UTF-8")
todos_candidatos$Localidade <- iconv(todos_candidatos$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
todos_candidatos$Situação_classe <- ifelse((todos_candidatos$Situação %in% c("Suplente","Não eleito")), "Não eleito", "Eleito")
todos_candidatos <- bind_cols(todos_candidatos, separa_partido_coligacao(todos_candidatos$Partido...Coligação)) %>%
select(Localidade, Cargo, Votação, Situação, Situação_classe, Partido, Coligação, Numero_candidato = Nº)
candidatos <- informacoes_pessoais_candidatos %>% inner_join(todos_candidatos, by = c("Descricao_ue" = "Localidade", "Numero_candidato_urna" = "Numero_candidato"))
# Adiciona limite de despesas para cada cargo e municipio
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F, encoding = "UTF-8")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador) %>%
melt(id=c("municipio")) %>%
rename(Cargo = variable, Limite_de_despesas = value, Municipio = municipio) %>%
mutate(Cargo = as.character(Cargo))
candidatos <- candidatos %>% inner_join(limite_despesas_candidatos_pb, by = c("Descricao_ue" = "Municipio", "Cargo" = "Cargo"))
# Adiciona gastos para cada candidato
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_candidatos_pb$Nome.da.UE <- iconv(gastos_candidatos_pb$Nome.da.UE, from="latin1", to="ASCII//TRANSLIT")
candidatos <- gastos_candidatos_pb %>% group_by(CPF.do.candidato) %>%
summarise(Soma_gastos = sum(Valor.despesa)) %>%
right_join(candidatos, by = c("CPF.do.candidato" = "CPF_candidato"))
candidatos$Soma_gastos <- with(candidatos, ifelse(is.na(Soma_gastos),0,Soma_gastos))
# Adiciona abstencao
abstencao <- read.csv("../data/comparecimento_abstencao_localidade.csv", sep=";", dec = ",", stringsAsFactors = F, encoding = "UTF-8", header = T) %>%
select(Localidade, Cargo, Comparecimento, Abstenção)
abstencao$Localidade <- iconv(abstencao$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(abstencao, by = c("Descricao_ue" = "Localidade", "Cargo" = "Cargo"))
# Adiciona despesas dos candidatos
eleitorado_apto <- read.csv("../data/eleitorado_2016_mun.csv", sep=";") %>% filter(UF=="PB")
eleitorado_apto$MUNICIPIO <- iconv(eleitorado_apto$MUNICIPIO, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(eleitorado_apto, by = c("Descricao_ue" = "MUNICIPIO"))
# Adiciona informacoes das cidades
cidades <- read.csv("../data/municipios.csv", sep=";")
cidades <- read.csv("../data/municipios.csv", sep=";") %>% filter(ANO == 2010)
View(cidades)
cidades <- read.csv("../data/municipios.csv", sep=";") %>% filter(ANO == 2010, UF == 25)
View(cidades)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",") %>% filter(ANO == 2010, UF == 25)
View(cidades)
colnames(cidades)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",") %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, Indide_escolaridade = I_ESCOLARIDADE, IDHM, IDHM_E, IDHM_L, IDHM_R)
View(cidades)
View(cidades)
5565*3
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",") %>%
select(Municipio, Esperanca_vida = ESPVIDA, I_ESCOLARIDADE, IDHM, IDHM_E, IDHM_L, IDHM_R)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",") %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, I_ESCOLARIDADE, IDHM, IDHM_E, IDHM_L, IDHM_R)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",")
colnames(cidades)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",") %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",") %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R)
candidatos <- candidatos %>% inner_join(cidades, by = c("Descricao_ue" = "Municipio"))
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R)
candidatos <- candidatos %>% inner_join(cidades, by = c("Descricao_ue" = "Municipio"))
View(candidatos)
source("imports.R")
separa_partido_coligacao <- function(x){
partido_coligacao_list <- str_split(x, " / ", n = 2) %>%
lapply(function(y) {
if (is.na(y[2])) {
y[2] <- "-"
}
y
})
partido_coligacao <- do.call(rbind, partido_coligacao_list) %>% data.frame
partido_coligacao <- transmute(partido_coligacao, Partido=as.character(X1), Coligação=as.character(X2))
return(partido_coligacao)
}
# Informacoes pessoais dos candidatos
informacoes_pessoais_candidatos <- read.csv("../data/consulta_cand_2016_PB.txt", sep=";", header = F, stringsAsFactors = F, encoding = "latin1", col.names = c("Data_geracao","Dora_geracao","Ano_eleicao","Num_turno","Descricao_eleicao","Sigla_uf","Sigla_ue","Descricao_ue","Codigo_cargo","Descricao_cargo","Nome_candidato","Sequencial_candidato",
"Numero_candidato_urna","CPF_candidato","Nome_urna_candidato","Cod_situacao_candidatura","Descricao_situacao_candidatura","Numero_partido","Sigla_partido","Nome_partido","Codigo_legenda","Sigla_legenda","Composicao_legenda","Nome_legenda",
"Codigo_ocupacao","Descricao_ocupacao","Data_nascimento","Num_titulo_eleitoral_candidato","Idade_data_eleicao","Codigo_sexo","Descricao_sexo","Cod_grau_instrucao","Descricao_grau_instrucao","Codigo_estado_civil","Descricao_estado_civil","Codigo_cor_raca",
"Descricao_cor_raca","Codigo_nacionalidade","Descricao_nacionalidade","Sigla_uf_nascimento","Codigo_municipio_nascimento","Nome_municipio_nascimento","Despesa_max_campanha","Cod_situacao_totalizacao_turno","Descricao_situacao_totalizacao_turno","Email"))
informacoes_pessoais_candidatos <- informacoes_pessoais_candidatos %>% filter(Descricao_cargo %in% c("PREFEITO","VEREADOR"), Descricao_situacao_candidatura %in% c("DEFERIDO","DEFERIDO COM RECURSO")) %>%
select(Nome_candidato,CPF_candidato,Descricao_ue,-Descricao_cargo,Numero_candidato_urna,-Descricao_situacao_candidatura,Descricao_ocupacao,Idade_data_eleicao,Descricao_sexo,Descricao_grau_instrucao,Descricao_estado_civil,Descricao_cor_raca,Descricao_nacionalidade,Sigla_uf_nascimento,Nome_municipio_nascimento)
informacoes_pessoais_candidatos$Descricao_ue <- iconv(informacoes_pessoais_candidatos$Descricao_ue, from="latin1", to="ASCII//TRANSLIT")
# Adiciona cargo, partido, coligação e votação dos candidatos
todos_candidatos <- read.csv("../data/eleicao_todos_candidatos.csv", sep=";", stringsAsFactors = F, encoding = "UTF-8")
todos_candidatos$Localidade <- iconv(todos_candidatos$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
todos_candidatos$Situação_classe <- ifelse((todos_candidatos$Situação %in% c("Suplente","Não eleito")), "Não eleito", "Eleito")
todos_candidatos <- bind_cols(todos_candidatos, separa_partido_coligacao(todos_candidatos$Partido...Coligação)) %>%
select(Localidade, Cargo, Votação, Situação, Situação_classe, Partido, Coligação, Numero_candidato = Nº)
candidatos <- informacoes_pessoais_candidatos %>% inner_join(todos_candidatos, by = c("Descricao_ue" = "Localidade", "Numero_candidato_urna" = "Numero_candidato"))
# Adiciona limite de despesas para cada cargo e municipio
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F, encoding = "UTF-8")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador) %>%
melt(id=c("municipio")) %>%
rename(Cargo = variable, Limite_de_despesas = value, Municipio = municipio) %>%
mutate(Cargo = as.character(Cargo))
candidatos <- candidatos %>% inner_join(limite_despesas_candidatos_pb, by = c("Descricao_ue" = "Municipio", "Cargo" = "Cargo"))
# Adiciona gastos para cada candidato
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_candidatos_pb$Nome.da.UE <- iconv(gastos_candidatos_pb$Nome.da.UE, from="latin1", to="ASCII//TRANSLIT")
candidatos <- gastos_candidatos_pb %>% group_by(CPF.do.candidato) %>%
summarise(Soma_gastos = sum(Valor.despesa)) %>%
right_join(candidatos, by = c("CPF.do.candidato" = "CPF_candidato"))
candidatos$Soma_gastos <- with(candidatos, ifelse(is.na(Soma_gastos),0,Soma_gastos))
# Adiciona abstencao
abstencao <- read.csv("../data/comparecimento_abstencao_localidade.csv", sep=";", dec = ",", stringsAsFactors = F, encoding = "UTF-8", header = T) %>%
select(Localidade, Cargo, Comparecimento, Abstenção)
abstencao$Localidade <- iconv(abstencao$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(abstencao, by = c("Descricao_ue" = "Localidade", "Cargo" = "Cargo"))
# Adiciona despesas dos candidatos
eleitorado_apto <- read.csv("../data/eleitorado_2016_mun.csv", sep=";") %>% filter(UF=="PB")
eleitorado_apto$MUNICIPIO <- iconv(eleitorado_apto$MUNICIPIO, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(eleitorado_apto, by = c("Descricao_ue" = "MUNICIPIO"))
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R)
unique(cidades$Municipio)
unique(cidades$Municipio) %in% unique(candidatos$Descricao_ue)
!(unique(cidades$Municipio) %in% unique(candidatos$Descricao_ue))
cidades$Municipio[!(unique(cidades$Municipio) %in% unique(candidatos$Descricao_ue))]
unique(candidatos$Descricao_ue)
unique(cidades$Municipio)
cidades$Municipio[!(unique(cidades$Municipio) %in% unique(candidatos$Descricao_ue))]
View(cidades)
View(candidatos)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R) %>%
mutate(Municipio=replace(Municipio, "SAO DOMINGOS", "SAO DOMINGOS DE POMBAL"))
Municipio=replace(Municipio, "SAO DOMINGOS", "SAO DOMINGOS DE POMBAL")
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R)
mtcars %>%
mutate(mpg=replace(mpg, cyl==4, NA)) %>%
as.data.frame()
mtcars
?replace
mtcars %>%
mutate(replace(mpg, cyl==4, NA)) %>%
as.data.frame()
mtcars
mtcars %>%
mutate(replace(mpg, cyl==4, NA)) %>%
as.data.frame()
mtcars %>%
mutate(mpg=replace(mpg, cyl==4, NA)) %>%
as.data.frame()
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R) %>%
mutate(Municipio=replace(Municipio, Municipio=="SAO DOMINGOS", "SAO DOMINGOS DE POMBAL")) %>%
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R) %>%
mutate(Municipio=replace(Municipio, Municipio=="SAO DOMINGOS", "SAO DOMINGOS DE POMBAL"))
View(cidades)
candidatos <- candidatos %>% inner_join(cidades, by = c("Descricao_ue" = "Municipio"))
View(candidatos)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, I_ESCOLARIDADE, IDHM, IDHM_E, IDHM_L, IDHM_R) %>%
mutate(Municipio=replace(Municipio, Municipio=="SAO DOMINGOS", "SAO DOMINGOS DE POMBAL"))
View(cidades)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25)
colnames(cidades)
View(cidades)
View(cidades)
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R) %>%
mutate(Municipio=replace(Municipio, Municipio=="SAO DOMINGOS", "SAO DOMINGOS DE POMBAL"))
write.table(candidatos, "../data/candidatos.csv" ,sep=";", row.names = F, quote = F)
source("imports.R")
separa_partido_coligacao <- function(x){
partido_coligacao_list <- str_split(x, " / ", n = 2) %>%
lapply(function(y) {
if (is.na(y[2])) {
y[2] <- "-"
}
y
})
partido_coligacao <- do.call(rbind, partido_coligacao_list) %>% data.frame
partido_coligacao <- transmute(partido_coligacao, Partido=as.character(X1), Coligação=as.character(X2))
return(partido_coligacao)
}
# Informacoes pessoais dos candidatos
informacoes_pessoais_candidatos <- read.csv("../data/consulta_cand_2016_PB.txt", sep=";", header = F, stringsAsFactors = F, encoding = "latin1", col.names = c("Data_geracao","Dora_geracao","Ano_eleicao","Num_turno","Descricao_eleicao","Sigla_uf","Sigla_ue","Descricao_ue","Codigo_cargo","Descricao_cargo","Nome_candidato","Sequencial_candidato",
"Numero_candidato_urna","CPF_candidato","Nome_urna_candidato","Cod_situacao_candidatura","Descricao_situacao_candidatura","Numero_partido","Sigla_partido","Nome_partido","Codigo_legenda","Sigla_legenda","Composicao_legenda","Nome_legenda",
"Codigo_ocupacao","Descricao_ocupacao","Data_nascimento","Num_titulo_eleitoral_candidato","Idade_data_eleicao","Codigo_sexo","Descricao_sexo","Cod_grau_instrucao","Descricao_grau_instrucao","Codigo_estado_civil","Descricao_estado_civil","Codigo_cor_raca",
"Descricao_cor_raca","Codigo_nacionalidade","Descricao_nacionalidade","Sigla_uf_nascimento","Codigo_municipio_nascimento","Nome_municipio_nascimento","Despesa_max_campanha","Cod_situacao_totalizacao_turno","Descricao_situacao_totalizacao_turno","Email"))
informacoes_pessoais_candidatos <- informacoes_pessoais_candidatos %>% filter(Descricao_cargo %in% c("PREFEITO","VEREADOR"), Descricao_situacao_candidatura %in% c("DEFERIDO","DEFERIDO COM RECURSO")) %>%
select(Nome_candidato,CPF_candidato,Descricao_ue,-Descricao_cargo,Numero_candidato_urna,-Descricao_situacao_candidatura,Descricao_ocupacao,Idade_data_eleicao,Descricao_sexo,Descricao_grau_instrucao,Descricao_estado_civil,Descricao_cor_raca,Descricao_nacionalidade,Sigla_uf_nascimento,Nome_municipio_nascimento)
informacoes_pessoais_candidatos$Descricao_ue <- iconv(informacoes_pessoais_candidatos$Descricao_ue, from="latin1", to="ASCII//TRANSLIT")
# Adiciona cargo, partido, coligação e votação dos candidatos
todos_candidatos <- read.csv("../data/eleicao_todos_candidatos.csv", sep=";", stringsAsFactors = F, encoding = "UTF-8")
todos_candidatos$Localidade <- iconv(todos_candidatos$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
todos_candidatos$Situação_classe <- ifelse((todos_candidatos$Situação %in% c("Suplente","Não eleito")), "Não eleito", "Eleito")
todos_candidatos <- bind_cols(todos_candidatos, separa_partido_coligacao(todos_candidatos$Partido...Coligação)) %>%
select(Localidade, Cargo, Votação, Situação, Situação_classe, Partido, Coligação, Numero_candidato = Nº)
candidatos <- informacoes_pessoais_candidatos %>% inner_join(todos_candidatos, by = c("Descricao_ue" = "Localidade", "Numero_candidato_urna" = "Numero_candidato"))
# Adiciona limite de despesas para cada cargo e municipio
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F, encoding = "UTF-8")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador) %>%
melt(id=c("municipio")) %>%
rename(Cargo = variable, Limite_de_despesas = value, Municipio = municipio) %>%
mutate(Cargo = as.character(Cargo))
candidatos <- candidatos %>% inner_join(limite_despesas_candidatos_pb, by = c("Descricao_ue" = "Municipio", "Cargo" = "Cargo"))
# Adiciona gastos para cada candidato
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_candidatos_pb$Nome.da.UE <- iconv(gastos_candidatos_pb$Nome.da.UE, from="latin1", to="ASCII//TRANSLIT")
candidatos <- gastos_candidatos_pb %>% group_by(CPF.do.candidato) %>%
summarise(Soma_gastos = sum(Valor.despesa)) %>%
right_join(candidatos, by = c("CPF.do.candidato" = "CPF_candidato"))
candidatos$Soma_gastos <- with(candidatos, ifelse(is.na(Soma_gastos),0,Soma_gastos))
# Adiciona abstencao
abstencao <- read.csv("../data/comparecimento_abstencao_localidade.csv", sep=";", dec = ",", stringsAsFactors = F, encoding = "UTF-8", header = T) %>%
select(Localidade, Cargo, Comparecimento, Abstenção)
abstencao$Localidade <- iconv(abstencao$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(abstencao, by = c("Descricao_ue" = "Localidade", "Cargo" = "Cargo"))
# Adiciona despesas dos candidatos
eleitorado_apto <- read.csv("../data/eleitorado_2016_mun.csv", sep=";") %>% filter(UF=="PB")
eleitorado_apto$MUNICIPIO <- iconv(eleitorado_apto$MUNICIPIO, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(eleitorado_apto, by = c("Descricao_ue" = "MUNICIPIO"))
# Adiciona informacoes das cidades
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R) %>%
mutate(Municipio=replace(Municipio, Municipio=="SAO DOMINGOS", "SAO DOMINGOS DE POMBAL"))
candidatos <- candidatos %>% inner_join(cidades, by = c("Descricao_ue" = "Municipio"))
View(candidatos)
write.table(candidatos, "../data/candidatos.csv" ,sep=";", row.names = F, quote = F)
source("imports.R")
separa_partido_coligacao <- function(x){
partido_coligacao_list <- str_split(x, " / ", n = 2) %>%
lapply(function(y) {
if (is.na(y[2])) {
y[2] <- "-"
}
y
})
partido_coligacao <- do.call(rbind, partido_coligacao_list) %>% data.frame
partido_coligacao <- transmute(partido_coligacao, Partido=as.character(X1), Coligação=as.character(X2))
return(partido_coligacao)
}
# Informacoes pessoais dos candidatos
informacoes_pessoais_candidatos <- read.csv("../data/consulta_cand_2016_PB.txt", sep=";", header = F, stringsAsFactors = F, encoding = "latin1", col.names = c("Data_geracao","Dora_geracao","Ano_eleicao","Num_turno","Descricao_eleicao","Sigla_uf","Sigla_ue","Descricao_ue","Codigo_cargo","Descricao_cargo","Nome_candidato","Sequencial_candidato",
"Numero_candidato_urna","CPF_candidato","Nome_urna_candidato","Cod_situacao_candidatura","Descricao_situacao_candidatura","Numero_partido","Sigla_partido","Nome_partido","Codigo_legenda","Sigla_legenda","Composicao_legenda","Nome_legenda",
"Codigo_ocupacao","Descricao_ocupacao","Data_nascimento","Num_titulo_eleitoral_candidato","Idade_data_eleicao","Codigo_sexo","Descricao_sexo","Cod_grau_instrucao","Descricao_grau_instrucao","Codigo_estado_civil","Descricao_estado_civil","Codigo_cor_raca",
"Descricao_cor_raca","Codigo_nacionalidade","Descricao_nacionalidade","Sigla_uf_nascimento","Codigo_municipio_nascimento","Nome_municipio_nascimento","Despesa_max_campanha","Cod_situacao_totalizacao_turno","Descricao_situacao_totalizacao_turno","Email"))
informacoes_pessoais_candidatos <- informacoes_pessoais_candidatos %>% filter(Descricao_cargo %in% c("PREFEITO","VEREADOR"), Descricao_situacao_candidatura %in% c("DEFERIDO","DEFERIDO COM RECURSO")) %>%
select(Nome_candidato,CPF_candidato,Descricao_ue,-Descricao_cargo,Numero_candidato_urna,-Descricao_situacao_candidatura,Descricao_ocupacao,Idade_data_eleicao,Descricao_sexo,Descricao_grau_instrucao,Descricao_estado_civil,Descricao_cor_raca,Descricao_nacionalidade,Sigla_uf_nascimento,Nome_municipio_nascimento)
informacoes_pessoais_candidatos$Descricao_ue <- iconv(informacoes_pessoais_candidatos$Descricao_ue, from="latin1", to="ASCII//TRANSLIT")
# Adiciona cargo, partido, coligação e votação dos candidatos
todos_candidatos <- read.csv("../data/eleicao_todos_candidatos.csv", sep=";", stringsAsFactors = F, encoding = "UTF-8")
todos_candidatos$Localidade <- iconv(todos_candidatos$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
todos_candidatos$Situação_classe <- ifelse((todos_candidatos$Situação %in% c("Suplente","Não eleito")), "Não eleito", "Eleito")
todos_candidatos <- bind_cols(todos_candidatos, separa_partido_coligacao(todos_candidatos$Partido...Coligação)) %>%
select(Localidade, Cargo, Votação, Situação, Situação_classe, Partido, Coligação, Numero_candidato = Nº)
candidatos <- informacoes_pessoais_candidatos %>% inner_join(todos_candidatos, by = c("Descricao_ue" = "Localidade", "Numero_candidato_urna" = "Numero_candidato"))
# Adiciona limite de despesas para cada cargo e municipio
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F, encoding = "UTF-8")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador) %>%
melt(id=c("municipio")) %>%
rename(Cargo = variable, Limite_de_despesas = value, Municipio = municipio) %>%
mutate(Cargo = as.character(Cargo))
candidatos <- candidatos %>% inner_join(limite_despesas_candidatos_pb, by = c("Descricao_ue" = "Municipio", "Cargo" = "Cargo"))
# Adiciona gastos para cada candidato
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_candidatos_pb$Nome.da.UE <- iconv(gastos_candidatos_pb$Nome.da.UE, from="latin1", to="ASCII//TRANSLIT")
candidatos <- gastos_candidatos_pb %>% group_by(CPF.do.candidato) %>%
summarise(Soma_gastos = sum(Valor.despesa)) %>%
right_join(candidatos, by = c("CPF.do.candidato" = "CPF_candidato"))
candidatos$Soma_gastos <- with(candidatos, ifelse(is.na(Soma_gastos),0,Soma_gastos))
# Adiciona abstencao
abstencao <- read.csv("../data/comparecimento_abstencao_localidade.csv", sep=";", dec = ",", stringsAsFactors = F, encoding = "UTF-8", header = T) %>%
select(Localidade, Cargo, Comparecimento, Abstenção)
abstencao$Localidade <- iconv(abstencao$Localidade, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(abstencao, by = c("Descricao_ue" = "Localidade", "Cargo" = "Cargo"))
# Adiciona despesas dos candidatos
eleitorado_apto <- read.csv("../data/eleitorado_2016_mun.csv", sep=";") %>% filter(UF=="PB")
eleitorado_apto$MUNICIPIO <- iconv(eleitorado_apto$MUNICIPIO, from="UTF-8", to="ASCII//TRANSLIT")
candidatos <- candidatos %>% inner_join(eleitorado_apto, by = c("Descricao_ue" = "MUNICIPIO"))
# Adiciona informacoes das cidades
cidades <- read.csv("../data/municipios.csv", sep=";", dec=",", stringsAsFactors = F) %>%
filter(ANO == 2010, UF == 25) %>%
select(Municipio, Esperanca_vida = ESPVIDA, IDHM, IDHM_E, IDHM_L, IDHM_R) %>%
mutate(Municipio=replace(Municipio, Municipio=="SAO DOMINGOS", "SAO DOMINGOS DE POMBAL"))
candidatos <- candidatos %>% inner_join(cidades, by = c("Descricao_ue" = "Municipio"))
write.table(candidatos, "../data/candidatos.csv" ,sep=";", row.names = F, quote = F)
source("imports.R")
candidatos <- read.csv("../data/candidatos.csv", sep=";")
candidatos$Porcentagem_limite_despesas <- with(candidatos, Soma_gastos/Limite_de_despesas)
candidatos$Porcentagem_limite_despesas <- with(candidatos, Soma_gastos/Limite_de_despesas)
View(candidatos)
vereadores <- candidatos %>% filter(Cargo == "Vereador")
prefeitos <-  candidatos %>% filter(Cargo == "Prefeito")
eleitos <- candidatos %>% filter(Cargo == "Vereador", Situação_classe == "Eleito")
shapiro.test(eleitos$IDHM_E)
qqnorm(eleitos$IDHM_E)
qqnorm(eleitos$Soma_gastos)
qqnorm(eleitos$Porcentagem_limite_despesas)
eleitos %>% cor.test(IDHM_E, Porcentagem_limite_despesas)
eleitos %>% cor.test(IDHM_E, Porcentagem_limite_despesas)
?cor.test
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas))
plot(IDHM_E, Porcentagem_limite_despesas)
with(eleitos, plot(IDHM_E, Porcentagem_limite_despesas))
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito")
qqnorm(eleitos$IDHM_E)
qqnorm(eleitos$Porcentagem_limite_despesas)
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas))
with(eleitos, plot(IDHM_E, Porcentagem_limite_despesas))
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas, method = "spearman"))
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas, method = "Spearman"))
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas, method = "spearman"))
?cor.test
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas, method = "kendall"))
with(eleitos, plot(IDHM_E, Porcentagem_limite_despesas))
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas))
with(eleitos, plot(IDHM_E, Porcentagem_limite_despesas))
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito")
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito")
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito")
View(eleitos)
qqnorm(eleitos$Porcentagem_limite_despesas)
qqnorm(nao.eleitos$Porcentagem_limite_despesas)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>% filter(Porcentagem_limite_despesas < 1)
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito")
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>% filter(Porcentagem_limite_despesas <= 1)
qqnorm(eleitos$Porcentagem_limite_despesas)
qqnorm(nao.eleitos$Porcentagem_limite_despesas)
wilcox.test(eleitos$Porcentagem_limite_despesas, nao.eleitos$Porcentagem_limite_despesas)
View(nao.eleitos)
View(candidatos)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
group_by(Descricao_ue) %>% summarise(max(Porcentagem_limite_despesas))
View(nao.eleitos)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(max(Porcentagem_limite_despesas))
View(eleitos)
View(nao.eleitos)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
View(nao.eleitos)
eleitos$Descricao_ue[!(eleitos$Descricao_ue %in% nao.eleitos$Descricao_ue)]
candidatos %>% filter(Cargo == "Prefeito", Descricao_ue == "SAO MAMEDE")
a<-candidatos %>% filter(Cargo == "Prefeito", Descricao_ue == "SAO MAMEDE")
View(a)
candidatos$Descricao_ue[!(candidatos$Descricao_ue %in% nao.eleitos$Descricao_ue)]
candidatos$Descricao_ue[!(candidatos$Descricao_ue %in% eleitos$Descricao_ue)]
a<-candidatos %>% filter(Cargo == "Prefeito", Descricao_ue == "SOLEDADE")
View(candidatos)
View(a)
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito", Descricao_ue %in% nao.eleitos$Descricao_ue)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito", Descricao_ue %in% nao.eleitos$Descricao_ue)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
View(nao.eleitos)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
source("imports.R")
candidatos <- read.csv("../data/candidatos.csv", sep=";")
candidatos$Porcentagem_limite_despesas <- with(candidatos, Soma_gastos/Limite_de_despesas)
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito")
qqnorm(eleitos$IDHM_E)
qqnorm(eleitos$Porcentagem_limite_despesas)
with(eleitos, cor.test(IDHM_E, Porcentagem_limite_despesas))
with(eleitos, plot(IDHM_E, Porcentagem_limite_despesas))
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
View(nao.eleitos)
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito", Descricao_ue %in% nao.eleitos$Descricao_ue)
View(nao.eleitos)
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito")
eleitos <- eleitos[eleitos$Descricao_ue %in% nao.eleitos$Descricao_ue,]
View(eleitos)
View(nao.eleitos)
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito")
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito")
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito", Descricao_ue %in% nao.eleitos$Descricao_ue)
nao.eleitos <- nao.eleitos %>% filter(Descricao_ue %in% eleitos$Descricao_ue)
qqnorm(eleitos$Porcentagem_limite_despesas)
qqnorm(nao.eleitos$Porcentagem_limite_despesas)
wilcox.test(eleitos$Porcentagem_limite_despesas, nao.eleitos$Porcentagem_limite_despesas)
eleitos$Porcentagem_limite_despesas
nao.eleitos$Porcentagem_limite_despesas
mean(eleitos$Porcentagem_limite_despesas)
mean(nao.eleitos$Porcentagem_limite_despesas)
?qqplot
wilcox.test(eleitos$Porcentagem_limite_despesas, nao.eleitos$Porcentagem_limite_despesas)
View(nao.eleitos)
View(eleitos)
?wilcox.test
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito", Descricao_ue %in% nao.eleitos$Descricao_ue) %>% arrange(Descricao_ue)
nao.eleitos <- nao.eleitos %>% filter(Descricao_ue %in% eleitos$Descricao_ue) %>% arrange(Descricao_ue)
qqnorm(eleitos$Porcentagem_limite_despesas)
qqnorm(nao.eleitos$Porcentagem_limite_despesas)
mean(eleitos$Porcentagem_limite_despesas)
mean(nao.eleitos$Porcentagem_limite_despesas)
nao.eleitos$Porcentagem_limite_despesas
eleitos$Porcentagem_limite_despesas
View(eleitos)
View(nao.eleitos)
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito", Descricao_ue %in% nao.eleitos$Descricao_ue) %>% arrange(Descricao_ue) %>% select(Descricao_ue, Porcentagem_limite_despesas)
nao.eleitos <- nao.eleitos %>% filter(Descricao_ue %in% eleitos$Descricao_ue) %>% arrange(Descricao_ue)
View(eleitos)
View(nao.eleitos)
qqnorm(eleitos$Porcentagem_limite_despesas)
qqnorm(nao.eleitos$Porcentagem_limite_despesas)
qqnorm(eleitos$Porcentagem_limite_despesas)
qqnorm(nao.eleitos$Porcentagem_limite_despesas)
table(eleitos$Porcentagem_limite_despesas > nao.eleitos$Porcentagem_limite_despesas)
mean(eleitos$Porcentagem_limite_despesas)
mean(nao.eleitos$Porcentagem_limite_despesas)
nao.eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Não eleito") %>%
filter(Porcentagem_limite_despesas <= 1) %>% #outlier
group_by(Descricao_ue) %>% summarise(Porcentagem_limite_despesas = max(Porcentagem_limite_despesas))
eleitos <- candidatos %>% filter(Cargo == "Prefeito", Situação_classe == "Eleito", Descricao_ue %in% nao.eleitos$Descricao_ue) %>% arrange(Descricao_ue) %>% select(Descricao_ue, Porcentagem_limite_despesas)
nao.eleitos <- nao.eleitos %>% filter(Descricao_ue %in% eleitos$Descricao_ue) %>% arrange(Descricao_ue)
qqnorm(eleitos$Porcentagem_limite_despesas)
qqnorm(nao.eleitos$Porcentagem_limite_despesas)
table(eleitos$Porcentagem_limite_despesas > nao.eleitos$Porcentagem_limite_despesas)
mean(eleitos$Porcentagem_limite_despesas)
mean(nao.eleitos$Porcentagem_limite_despesas)
wilcox.test(eleitos$Porcentagem_limite_despesas, nao.eleitos$Porcentagem_limite_despesas, paired = T)
129-89
129/(129+89)
mean(eleitos$Porcentagem_limite_despesas); mean(nao.eleitos$Porcentagem_limite_despesas)
qqnorm(eleitos$Porcentagem_limite_despesas); qqnorm(nao.eleitos$Porcentagem_limite_despesas)
mean(eleitos$Porcentagem_limite_despesas) mean(nao.eleitos$Porcentagem_limite_despesas)
hist(eleitos$Porcentagem_limite_despesas)
hist(nao.eleitos$Porcentagem_limite_despesas)
hist(eleitos$Porcentagem_limite_despesas); hist(nao.eleitos$Porcentagem_limite_despesas)
summary(eleitos$Porcentagem_limite_despesas); summary(nao.eleitos$Porcentagem_limite_despesas)
View(eleitos)
View(nao.eleitos)
