if(!require(readODS)){
install.packages("readODS")
}
library(readODS)
library(readODS)
?read.ods
contas_irregulares <- read.ods('../data/Contas_julgadas_Irregulares_TRE_2016.ods', sheetIndex = 1)
contas_irregulares <- read.ods('../data/Contas_julgadas_Irregulares_TRE_2016.ods')
contas_irregulares <- read.ods('../data/Contas_julgadas_Irregulares_TRE_2016.ods', sheet=0)
contas_irregulares <- read.ods('../data/Contas_julgadas_Irregulares_TRE_2016.ods', sheet=1)
View(contas_irregulares)
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
View(contas_irregulares)
contas_irregulares <- read.ods('../data/Contas_julgadas_Irregulares_TRE_2016.ods', sheet=1, header=T)
View(contas_irregulares)
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
contas_irregulares <- read.csv('../data/Contas_julgadas_Irregulares_TRE_2016.csv')
View(contas_irregulares)
contas_irregulares <- read.csv('../data/Contas_julgadas_Irregulares_TRE_2016.csv'', encoding = "UTF-8", stringsAsFactors = F)
contas_irregulares <- read.csv('../data/Contas_julgadas_Irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
contas_irregulares <- read.csv('../data/Contas_julgadas_Irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
View(contas_irregulares)
View(tre_sagres)
?mean
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
#contas_irregulares <- read.csv('../data/Contas_julgadas_Irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
View(indicadores_cont_PB)
mean_percentage(x){
mean(x, trim=0.1)*100
}
mean_percentage <- function(x){
mean(x, trim=0.1)*100
}
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
#contas_irregulares <- read.csv('../data/Contas_julgadas_Irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = format_number(Media_Dispensas_PB/Media_Contratos_PB), Media_Convite_PB_Percent = format_number(Media_Convites_PB/Media_Contratos_PB), Media_Aditivos_Prazo_PB_Percent = format_number(Media_Aditivos_Prazo_PB/Media_Contratos_PB), Media_Aditivos_Valor_PB_Percent = format_number(Media_Aditivos_Valor_PB/Media_Contratos_PB))
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
View(indicadores_cont_cid)
View(indicadores_cont_cid_candidatos)
View(indicadores_cont_PB)
trunc(70.11245)
?trunc
trunc
?trunc
format_number <- function(x){
int = trunc(x)
if(int!=0){
return(trunc)
}
return(round(int, digits=3)*100)
}
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = format_number(Media_Dispensas_PB/Media_Contratos_PB), Media_Convite_PB_Percent = format_number(Media_Convites_PB/Media_Contratos_PB), Media_Aditivos_Prazo_PB_Percent = format_number(Media_Aditivos_Prazo_PB/Media_Contratos_PB), Media_Aditivos_Valor_PB_Percent = format_number(Media_Aditivos_Valor_PB/Media_Contratos_PB))
View(indicadores_cont_PB)
contas_irregulares <- read.csv('../data/contas_julgadas_irregulares_TRE_2016.csv', sheetIndex = 1)
contas_irregulares <- read.csv('../data/contas_julgadas_irregulares_TRE_2016.csv')
View(contas_irregulares)
contas_irregulares <- read.csv('../data/contas_julgadas_irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
View(contas_irregulares)
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
contas_irregulares <- read.csv('../data/contas_julgadas_irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
contas_irregulares <- read.csv('../data/contas_julgadas_irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
View(indicadores_cont_cid_candidatos)
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
contas_irregulares <- read.csv('../data/contas_julgadas_irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
View(indicadores_cont_cid_candidatos)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
source("imports.R")
tre_sagres <- read.csv('../data/tre_sagres_unificado.csv', encoding = "UTF-8", stringsAsFactors = F)
cidades <- read.csv('../data/municipios.csv', encoding = "UTF-8", sep = ";", dec = ",", stringsAsFactors = F) %>%
filter(UF==25, ANO == max(ANO)) %>% rename(de_Ugestora = Municipio)
contas_irregulares <- read.csv('../data/contas_julgadas_irregulares_TRE_2016.csv', encoding = "UTF-8", stringsAsFactors = F)
tre_sagres$de_Ugestora[tre_sagres$de_Ugestora == "CAMPO DE SANTANA"] <- "TACIMA"
tre_sagres$classe <- with(tre_sagres, ifelse(classe == "IRREGULAR", "SIM", "NAO"))
tre_sagres <- rename(tre_sagres, Ini_Gestao = dt_Ano)
tre_sagres <- mutate(tre_sagres, Fim_Gestao = Ini_Gestao+3)
format_number <- function(x){
round(x, digits=3)*100
}
indicadores_cont_cid <- full_join(tre_sagres, cidades, by = "de_Ugestora") %>%
mutate(nu_Dispensas_Percent = format_number(nu_Dispensas_Prop_Contratos), nu_Aditivo_Prazo_Percent = format_number(nu_Aditivo_Prazo_Prop_Contratos),
nu_Aditivo_Valor_Percent = format_number(nu_Aditivo_Valor_Prop_Contratos), nu_Convites_Percent = format_number(nu_Convites_Prop_Contratos))
indicadores_cont_PB <- indicadores_cont_cid %>% group_by(Ini_Gestao) %>%
summarise(Media_Contratos_PB = mean(nu_Contratos, trim=0.1), Media_Dispensas_PB=mean(nu_Dispensas, trim=0.1), Media_Aditivos_Prazo_PB=mean(nu_Aditivo_Prazo, trim=0.1), Media_Aditivos_Valor_PB=mean(nu_Aditivo_Valor, trim=0.1), Media_Convites_PB=mean(nu_Convites, trim=0.1),
IDHM_PB = mean(IDHM), IDHM_E_PB = mean(IDHM_E), IDHM_L_PB = mean(IDHM_L), IDHM_R_PB = mean(IDHM_R), Ind_Escolaridade_PB = mean(I_ESCOLARIDADE), Exp_Vida_PB = mean(ESPVIDA)) %>%
mutate(Media_Dispensas_PB_Percent = Media_Dispensas_PB/Media_Contratos_PB, Media_Convite_PB_Percent = Media_Convites_PB/Media_Contratos_PB, Media_Aditivos_Prazo_PB_Percent = Media_Aditivos_Prazo_PB/Media_Contratos_PB, Media_Aditivos_Valor_PB_Percent = Media_Aditivos_Valor_PB/Media_Contratos_PB)
indicadores_cont_cid_candidatos <- indicadores_cont_cid %>%
filter(Candidato2016) %>%
select(Prefeitura = de_Ugestora, Nome = Eleito, Ini_Gestao, Fim_Gestao, Irregular = classe,
nu_Contratos, nu_Dispensas, nu_Aditivo_Prazo, nu_Aditivo_Valor, nu_Convites,
nu_Dispensas_Percent, nu_Aditivo_Prazo_Percent, nu_Aditivo_Valor_Percent, nu_Convites_Percent,
Populacao = POP, Exp_Vida = ESPVIDA, Ind_Escolaridade = I_ESCOLARIDADE, IDHM, IDHM_Educacao = IDHM_E, IDHM_Longevidade = IDHM_L, IDHM_Renda = IDHM_R)
sink("../site/data/indices_estado.json")
cat(jsonlite::toJSON(indicadores_cont_PB))
sink()
sink("../site/data/indices_cidades.json")
cat(jsonlite::toJSON(indicadores_cont_cid_candidatos))
sink()
library("imports.R")
setwd("~/meu-prefeito/scripts")
library("imports.R")
library("imports.R")
source("imports.R")
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";")
limite_despesas_candidatos_pb$Município
iconv(limite_despesas_candidatos_pb$Município,to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb$Município[5527]
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município,to="ASCII//TRANSLIT")
View(limite_despesas_candidatos_pb)
View(limite_despesas_candidatos_pb)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";") %>% iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
View(limite_despesas_candidatos_pb)
limite_despesas_candidatos_pb <- filter(UF == "PB")
limite_despesas_candidatos_pb <- filter(UF = "PB")
limite_despesas_candidatos_pb %>% filter(UF = "PB")
limite_despesas_candidatos_pb %>% filter(UF == "PB")
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB")
View(a)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB")
View(a)
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB", limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto)
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB", limite_gasto_prefeito == Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador == Limite.de.Gasto.Vereador, eleitores_aptos == Eleitorado.Apto)
?filter
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(limite_gasto_prefeito == Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador == Limite.de.Gasto.Vereador, eleitores_aptos == Eleitorado.Apto)
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador == Limite.de.Gasto.Vereador, eleitores_aptos == Eleitorado.Apto)
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto)
View(a)
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto)
View(a)
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato) %>% summarise(soma_gastos = sum(Valor.despesa))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato) %>% summarise(soma_gastos = sum(Valor.despesa))
View(total_gastos_candidatos)
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
View(total_gastos_candidatos)
?melt
install.packages("reshape2")
library(reshape2)
View(a)
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB")
source("imports.R")
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB")
View(a)
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador = Limite.de.Gasto.Vereador)
data <- melt(a, id=c("municipio","eleitores_aptos"))
a<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno, limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto)
data <- melt(a, id=c("municipio","eleitores_aptos"))
View(data)
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>% melt(id=c("municipio","eleitores_aptos"))
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>% melt(id=c("municipio","eleitores_aptos"))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
source("imports.R")
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>% melt(id=c("municipio","eleitores_aptos"))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
View(gastos_candidatos_pb)
View(limite_despesas_candidatos_pb)
table(limite_despesas_candidatos_pb$municipio)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
View(limite_despesas_candidatos_pb)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, limite_gasto_prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
limite_gasto_vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>% melt(id=c("municipio","eleitores_aptos"))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
View(limite_despesas_candidatos_pb)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>% melt(id=c("municipio","eleitores_aptos"))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
View(limite_despesas_candidatos_pb)
full_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c("Nome.da.UE" = "municipio"))
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
full_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c("Nome.da.UE" = "municipio"))
full_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c("Nome.da.UE" = "municipio", "Cargo" = "variable"))
a <- full_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c("Nome.da.UE" = "municipio", "Cargo" = "variable"))
View(a)
View(total_gastos_candidatos)
View(limite_despesas_candidatos_pb)
View(total_gastos_candidatos)
View(limite_despesas_candidatos_pb)
View(total_gastos_candidatos)
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c("Nome.da.UE" = "municipio", "Cargo" = "variable"))
View(a)
View(limite_despesas_candidatos_pb)
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto)
View(limite_despesas_candidatos_pb)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>% select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno,
vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>% melt(id=c("municipio","eleitores_aptos"))
View(limite_despesas_candidatos_pb)
?mutate
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno, vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
mutate(cargo = variable, limite = value)
View(limite_despesas_candidatos_pb)
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno, vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
mutate(cargo = variable, limite = value)
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = municipio, Cargo = cargo))
View(limite_despesas_candidatos_pb)
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = municipio, Cargo = cargo))
?left_join
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = cargo))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(a)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno, vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
mutate(cargo = variable, limite = value)
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(a)
View(limite_despesas_candidatos_pb)
View(total_gastos_candidatos)
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno, vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",")
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno, vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value)
View(limite_despesas_candidatos_pb)
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(a)
str(total_gastos_candidatos)
str(limite_despesas_candidatos_pb)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F)
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno, vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value)
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
str(limite_despesas_candidatos_pb)
?mutate
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F)
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, prefeito = Limite.de.Gasto.Prefeito.1º.Turno, vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value) %>%
mutate(cargo = as.character(cargo))
str(limite_despesas_candidatos_pb)
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(a)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F)
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value) %>%
mutate(cargo = as.character(cargo))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(a)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F)
#limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value) %>%
mutate(cargo = as.character(cargo))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(a)
View(limite_despesas_candidatos_pb)
View(total_gastos_candidatos)
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F)
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value) %>%
mutate(cargo = as.character(cargo))
View(gastos_candidatos_pb)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F)
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite = value) %>%
mutate(cargo = as.character(cargo))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_candidatos_pb$Nome.da.UE <- iconv(gastos_candidatos_pb$Nome.da.UE, to="ASCII//TRANSLIT")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa))
a <- left_join(total_gastos_candidatos, limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(a)
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa)) %>%
left_join(limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(total_gastos_candidatos)
limite_despesas_candidatos_pb <- read.csv("../data/limite_gastos_campanha_eleitoral_2016.csv", sep=";", dec=",", stringsAsFactors = F)
limite_despesas_candidatos_pb$Município <- iconv(limite_despesas_candidatos_pb$Município, to="ASCII//TRANSLIT")
limite_despesas_candidatos_pb<-limite_despesas_candidatos_pb %>% filter(UF == "PB") %>%
select(municipio = Município, Prefeito = Limite.de.Gasto.Prefeito.1º.Turno, Vereador = Limite.de.Gasto.Vereador, eleitores_aptos = Eleitorado.Apto) %>%
melt(id=c("municipio","eleitores_aptos")) %>%
rename(cargo = variable, limite_de_despesas = value) %>%
mutate(cargo = as.character(cargo))
gastos_candidatos_pb <- read.csv("../data/despesas_candidatos_relatorio_financeiro_2016_PB.txt", sep=";", encoding = "latin1", dec = ",", stringsAsFactors = F)
gastos_candidatos_pb$Nome.da.UE <- iconv(gastos_candidatos_pb$Nome.da.UE, to="ASCII//TRANSLIT")
gastos_vereadores_pb <- filter(gastos_candidatos_pb, Cargo == "Vereador")
gastos_prefeitos_pb <- filter(gastos_candidatos_pb, Cargo == "Prefeito")
total_gastos_candidatos <- gastos_candidatos_pb %>% group_by(Nome.da.UE, Nome.candidato, Sigla..Partido, CPF.do.candidato, Cargo) %>% summarise(soma_gastos = sum(Valor.despesa)) %>%
left_join(limite_despesas_candidatos_pb, by = c(Nome.da.UE = "municipio", Cargo = "cargo"))
View(total_gastos_candidatos)
candidatos_eleitos <- read.csv("../data/eleicao_geral_resultado_candidatos.csv",sep=";")
View(candidatos_eleitos)
